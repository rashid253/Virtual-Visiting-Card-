<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Masterpiece Editable Carousel with Edit Form</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link 
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" 
    rel="stylesheet">
  <style>
    /* Reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #e6e9f0, #eef1f5);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      min-height: 100vh;
    }
    /* Carousel Wrapper */
    .carousel-wrapper {
      position: relative;
      width: 100%;
      max-width: 1000px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    /* Slides Container */
    .slides {
      display: flex;
      transition: transform 0.8s ease;
      width: 400%; /* 4 slides */
    }
    /* Each Card/Slide */
    .slide {
      flex: 1 0 100%;
      padding: 20px;
    }
    /* Each Card has a unique style */
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .card.card-1 { background: #fff0f5; width: 90%; margin: auto; }
    .card.card-2 { background: #f0ffff; width: 95%; margin: auto; }
    .card.card-3 { background: #f5fffa; width: 92%; margin: auto; }
    .card.card-4 { background: #fffaf0; width: 88%; margin: auto; }
    
    /* Text Area */
    .text-area {
      flex: none;
    }
    .text-area h2,
    .text-area p {
      margin: 0;
      padding: 4px 0;
      overflow-wrap: break-word;
    }
    .text-area h2 {
      font-size: 1.8rem;
      color: #ff007f;
      font-weight: 600;
    }
    .text-area p {
      font-size: 1rem;
      color: #555;
      line-height: 1.5;
    }
    .text-area [contenteditable="true"] {
      border: 1px dashed #ccc;
      padding: 4px;
      border-radius: 4px;
    }
    .error {
      color: red;
      font-size: 0.9rem;
      margin-top: -4px;
    }
    /* Image Upload Section */
    .image-area {
      text-align: center;
      position: relative;
    }
    .image-area img {
      width: 100%;
      max-width: 300px;
      height: auto;
      object-fit: cover;
      border: 2px dashed #007bff;
      margin: 0 auto;
      display: block;
    }
    .upload-btn {
      margin-top: 8px;
      padding: 8px 16px;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    input[type="file"] { display: none; }
    /* Details Button */
    .details-btn {
      padding: 8px 16px;
      background: #28a745;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      align-self: flex-start;
    }
    /* Navigation Controls */
    .nav-controls {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 10px;
    }
    .nav-btn {
      padding: 8px 16px;
      background: #ff007f;
      color: #fff;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .dots {
      text-align: center;
      margin-top: 12px;
    }
    .dot {
      display: inline-block;
      width: 12px;
      height: 12px;
      margin: 0 5px;
      border-radius: 50%;
      background: #bbb;
      cursor: pointer;
      transition: background 0.3s;
    }
    .dot.active { background: #ff007f; }
    /* Form Styles */
    form#editForm {
      background: #fff;
      padding: 16px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      max-width: 500px;
      width: 100%;
      margin-top: 30px;
    }
    form#editForm h3 { margin-bottom: 12px; color: #333; }
    form#editForm label {
      display: block;
      margin: 8px 0 4px;
      font-weight: 600;
    }
    form#editForm input[type="text"],
    form#editForm textarea,
    form#editForm select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    form#editForm textarea { resize: vertical; }
    form#editForm button {
      margin-top: 12px;
      padding: 10px 20px;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
    }
    /* Responsive adjustments */
    @media (max-width: 600px) {
      .text-area h2 { font-size: 1.6rem; }
      .text-area p { font-size: 0.9rem; }
      .upload-btn, .details-btn, .nav-btn { font-size: 0.8rem; }
    }
  </style>
</head>
<body>

<!-- Carousel Wrapper -->
<div class="carousel-wrapper">
  <div class="slides">
    <!-- Slide 1 -->
    <div class="slide">
      <div class="card card-1">
        <div class="text-area">
          <h2 id="title1" contenteditable="true">Card 1 Title</h2>
          <p id="desc1" contenteditable="true">Card 1 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error1" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img1" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 1">
          <button class="upload-btn" data-card="1">Upload Image</button>
          <input type="file" class="file-input" data-card="1" accept="image/*">
        </div>
        <button class="details-btn" data-card="1">Details</button>
      </div>
    </div>
    <!-- Slide 2 -->
    <div class="slide">
      <div class="card card-2">
        <div class="text-area">
          <h2 id="title2" contenteditable="true">Card 2 Title</h2>
          <p id="desc2" contenteditable="true">Card 2 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error2" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img2" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 2">
          <button class="upload-btn" data-card="2">Upload Image</button>
          <input type="file" class="file-input" data-card="2" accept="image/*">
        </div>
        <button class="details-btn" data-card="2">Details</button>
      </div>
    </div>
    <!-- Slide 3 -->
    <div class="slide">
      <div class="card card-3">
        <div class="text-area">
          <h2 id="title3" contenteditable="true">Card 3 Title</h2>
          <p id="desc3" contenteditable="true">Card 3 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error3" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img3" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 3">
          <button class="upload-btn" data-card="3">Upload Image</button>
          <input type="file" class="file-input" data-card="3" accept="image/*">
        </div>
        <button class="details-btn" data-card="3">Details</button>
      </div>
    </div>
    <!-- Slide 4 -->
    <div class="slide">
      <div class="card card-4">
        <div class="text-area">
          <h2 id="title4" contenteditable="true">Card 4 Title</h2>
          <p id="desc4" contenteditable="true">Card 4 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error4" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img4" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 4">
          <button class="upload-btn" data-card="4">Upload Image</button>
          <input type="file" class="file-input" data-card="4" accept="image/*">
        </div>
        <button class="details-btn" data-card="4">Details</button>
      </div>
    </div>
  </div>
</div>

<!-- Navigation Controls -->
<div class="nav-controls">
  <button id="prevBtn" class="nav-btn">Prev</button>
  <button id="nextBtn" class="nav-btn">Next</button>
</div>
<div class="dots">
  <span class="dot active" data-index="0"></span>
  <span class="dot" data-index="1"></span>
  <span class="dot" data-index="2"></span>
  <span class="dot" data-index="3"></span>
</div>

<!-- Edit Form Section -->
<form id="editForm">
  <h3>Edit Card</h3>
  <label for="cardSelect">Select Card:</label>
  <select id="cardSelect">
    <option value="1">Card 1</option>
    <option value="2">Card 2</option>
    <option value="3">Card 3</option>
    <option value="4">Card 4</option>
  </select>
  
  <label for="newTitle">Title (max 10 words):</label>
  <input type="text" id="newTitle" placeholder="Enter new title" required>
  
  <label for="newDesc">Description (max 50 words):</label>
  <textarea id="newDesc" rows="3" placeholder="Enter new description" required></textarea>
  
  <label for="newImage">Upload New Image (optional):</label>
  <input type="file" id="newImage" accept="image/*">
  
  <button type="submit">Update Card</button>
</form>

<script>
  // ---------- Carousel Navigation ----------
  const slidesContainer = document.querySelector('.slides');
  const dots = document.querySelectorAll('.dot');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  let currentSlide = 0;
  const totalSlides = dots.length;

  function goToSlide(n) {
    currentSlide = (n + totalSlides) % totalSlides;
    slidesContainer.style.transform = 'translateX(-' + (currentSlide * 100) + '%)';
    dots.forEach(dot => dot.classList.remove('active'));
    dots[currentSlide].classList.add('active');
  }
  
  prevBtn.addEventListener('click', () => { goToSlide(currentSlide - 1); });
  nextBtn.addEventListener('click', () => { goToSlide(currentSlide + 1); });
  dots.forEach(dot => {
    dot.addEventListener('click', function() {
      goToSlide(parseInt(this.getAttribute('data-index')));
    });
  });
  
  // ---------- Editable Text with Word Limits (In-Card Editing) ----------
  const TITLE_LIMIT = 10;
  const DESC_LIMIT = 50;
  
  function enforceLimit(el, limit) {
    let words = el.innerText.trim().split(/\s+/);
    if(words.length > limit) {
      el.innerText = words.slice(0, limit).join(" ");
      placeCaretAtEnd(el);
    }
  }
  
  function placeCaretAtEnd(el) {
    el.focus();
    if (window.getSelection && document.createRange) {
      let range = document.createRange();
      range.selectNodeContents(el);
      range.collapse(false);
      let sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
    }
  }
  
  document.querySelectorAll('.text-area h2[contenteditable], .text-area p[contenteditable]').forEach(el => {
    el.addEventListener('input', function() {
      if(el.tagName === "H2") enforceLimit(el, TITLE_LIMIT);
      else enforceLimit(el, DESC_LIMIT);
    });
  });
  
  // ---------- Image Upload within Carousel ----------
  function resizeImage(file, maxWidth, callback) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const img = new Image();
      img.onload = function() {
        const canvas = document.createElement('canvas');
        let width = img.width;
        let height = img.height;
        if (width > maxWidth) {
          height = height * (maxWidth / width);
          width = maxWidth;
        }
        canvas.width = width;
        canvas.height = height;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, width, height);
        callback(canvas.toDataURL('image/jpeg', 0.8));
      }
      img.src = e.target.result;
    }
    reader.readAsDataURL(file);
  }
  
  document.querySelectorAll('.file-input').forEach(input => {
    input.addEventListener('change', function() {
      const cardNum = this.getAttribute('data-card');
      const file = this.files[0];
      if(file) {
        resizeImage(file, 300, function(resizedDataUrl) {
          const imageEl = document.getElementById('img' + cardNum);
          imageEl.src = resizedDataUrl;
          imageEl.style.border = 'none';
        });
      }
    });
  });
  
  document.querySelectorAll('.upload-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const cardNum = this.getAttribute('data-card');
      document.querySelector('.file-input[data-card="' + cardNum + '"]').click();
    });
  });
  
  document.querySelectorAll('.details-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const cardNum = this.getAttribute('data-card');
      alert("Details for Card " + cardNum + ":\n\nThis is a masterpiece card with custom styling. You can edit the text directly on the card or use the form below.");
    });
  });
  
  // ---------- Edit Form Functionality ----------
  document.getElementById('editForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const cardNum = document.getElementById('cardSelect').value;
    const newTitle = document.getElementById('newTitle').value.trim();
    const newDesc = document.getElementById('newDesc').value.trim();
    const imageFile = document.getElementById('newImage').files[0];
    
    // Check word limits
    if(newTitle.split(/\s+/).length > TITLE_LIMIT) {
      alert("Title exceeds " + TITLE_LIMIT + " words.");
      return;
    }
    if(newDesc.split(/\s+/).length > DESC_LIMIT) {
      alert("Description exceeds " + DESC_LIMIT + " words.");
      return;
    }
    
    // Update card title and description
    document.getElementById('title' + cardNum).innerText = newTitle;
    document.getElementById('desc' + cardNum).innerText = newDesc;
    
    // Update image if a new file is provided
    if(imageFile) {
      resizeImage(imageFile, 300, function(resizedDataUrl) {
        const imageEl = document.getElementById('img' + cardNum);
        imageEl.src = resizedDataUrl;
        imageEl.style.border = 'none';
      });
    }
    
    alert("Card " + cardNum + " updated successfully!");
    // Optionally, reset the form fields
    this.reset();
  });
  
</script>

</body>
</html>
