<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto Sliding Editable Carousel with Details Modal</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link 
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" 
    rel="stylesheet">
  <style>
    /* Reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #e6e9f0, #eef1f5);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      min-height: 100vh;
      position: relative;
    }
    /* Carousel Wrapper */
    .carousel-wrapper {
      position: relative;
      width: 100%;
      max-width: 1000px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    /* Slides Container */
    .slides {
      display: flex;
      transition: transform 0.8s ease;
      width: 400%; /* 4 slides */
    }
    /* Each Card/Slide */
    .slide {
      flex: 1 0 100%;
      padding: 20px;
    }
    /* Card Styles with Different Background Colors */
    .card {
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 12px;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .card:hover { transform: scale(1.02); }
    .card.card-1 { background: #fde2e2; width: 90%; margin: auto; }
    .card.card-2 { background: #e2f0cb; width: 95%; margin: auto; }
    .card.card-3 { background: #d0e6a5; width: 92%; margin: auto; }
    .card.card-4 { background: #a8dadc; width: 88%; margin: auto; }
    
    /* Text Area */
    .text-area {
      flex: none;
    }
    .text-area h2,
    .text-area p {
      margin: 0;
      padding: 4px 0;
      overflow-wrap: break-word;
    }
    .text-area h2 {
      font-size: 1.8rem;
      color: #333;
      font-weight: 600;
    }
    .text-area p {
      font-size: 1rem;
      color: #555;
      line-height: 1.5;
    }
    .text-area [contenteditable="true"] {
      border: 1px dashed #ccc;
      padding: 4px;
      border-radius: 4px;
    }
    .error {
      color: red;
      font-size: 0.9rem;
      margin-top: -4px;
    }
    /* Image Upload Section */
    .image-area {
      text-align: center;
      position: relative;
    }
    .image-area img {
      width: 100%;
      max-width: 300px;
      height: auto;
      object-fit: cover;
      border: 2px dashed #007bff;
      margin: 0 auto;
      display: block;
    }
    .upload-btn {
      margin-top: 8px;
      padding: 8px 16px;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    input[type="file"] { display: none; }
    /* Details Option Button on Card */
    .details-btn {
      padding: 8px 16px;
      background: #28a745;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      align-self: flex-start;
      margin-top: auto;
    }
    /* Centered Dots Navigation */
    .dots {
      text-align: center;
      margin-top: 12px;
    }
    .dot {
      display: inline-block;
      width: 12px;
      height: 12px;
      margin: 0 5px;
      border-radius: 50%;
      background: #bbb;
      cursor: pointer;
      transition: background 0.3s;
    }
    .dot.active { background: #ff007f; }
    
    /* Modal for Card Details */
    .modal {
      display: none;
      position: fixed;
      z-index: 100;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      width: 100%;
      position: relative;
    }
    .close-btn {
      position: absolute;
      top: 8px;
      right: 12px;
      background: #ff007f;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      cursor: pointer;
      font-size: 1rem;
    }
    /* Responsive adjustments */
    @media (max-width: 600px) {
      .text-area h2 { font-size: 1.6rem; }
      .text-area p { font-size: 0.9rem; }
      .upload-btn, .details-btn, .dot { font-size: 0.8rem; }
    }
  </style>
</head>
<body>

<!-- Carousel Wrapper -->
<div class="carousel-wrapper">
  <div class="slides">
    <!-- Slide 1 -->
    <div class="slide">
      <div class="card card-1" data-card="1" data-details="تفصیلات برائے کارڈ 1: یہ ایک منفرد کارڈ ہے جس میں آپ مواد ایڈٹ کر سکتے ہیں۔">
        <div class="text-area">
          <h2 id="title1" contenteditable="true">Card 1 Title</h2>
          <p id="desc1" contenteditable="true">Card 1 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error1" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img1" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 1">
          <button class="upload-btn" data-card="1">Upload Image</button>
          <input type="file" class="file-input" data-card="1" accept="image/*">
        </div>
        <button class="details-btn" data-card="1">View Details</button>
      </div>
    </div>
    <!-- Slide 2 -->
    <div class="slide">
      <div class="card card-2" data-card="2" data-details="تفصیلات برائے کارڈ 2: یہ کارڈ منفرد رنگ اور اسٹائل کے ساتھ آتا ہے۔">
        <div class="text-area">
          <h2 id="title2" contenteditable="true">Card 2 Title</h2>
          <p id="desc2" contenteditable="true">Card 2 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error2" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img2" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 2">
          <button class="upload-btn" data-card="2">Upload Image</button>
          <input type="file" class="file-input" data-card="2" accept="image/*">
        </div>
        <button class="details-btn" data-card="2">View Details</button>
      </div>
    </div>
    <!-- Slide 3 -->
    <div class="slide">
      <div class="card card-3" data-card="3" data-details="تفصیلات برائے کارڈ 3: یہاں آپ کو مزید معلومات اور تخصیصات ملیں گی۔">
        <div class="text-area">
          <h2 id="title3" contenteditable="true">Card 3 Title</h2>
          <p id="desc3" contenteditable="true">Card 3 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error3" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img3" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 3">
          <button class="upload-btn" data-card="3">Upload Image</button>
          <input type="file" class="file-input" data-card="3" accept="image/*">
        </div>
        <button class="details-btn" data-card="3">View Details</button>
      </div>
    </div>
    <!-- Slide 4 -->
    <div class="slide">
      <div class="card card-4" data-card="4" data-details="تفصیلات برائے کارڈ 4: یہ کارڈ جدید ڈیزائن اور اسٹائل کے ساتھ ہے۔">
        <div class="text-area">
          <h2 id="title4" contenteditable="true">Card 4 Title</h2>
          <p id="desc4" contenteditable="true">Card 4 description goes here. (Keep title under 10 words and description under 50 words.)</p>
          <div id="error4" class="error"></div>
        </div>
        <div class="image-area">
          <img id="img4" src="https://via.placeholder.com/300x200.png?text=Upload+Image" alt="Image 4">
          <button class="upload-btn" data-card="4">Upload Image</button>
          <input type="file" class="file-input" data-card="4" accept="image/*">
        </div>
        <button class="details-btn" data-card="4">View Details</button>
      </div>
    </div>
  </div>
</div>

<!-- Centered Dots Navigation -->
<div class="dots">
  <span class="dot active" data-index="0"></span>
  <span class="dot" data-index="1"></span>
  <span class="dot" data-index="2"></span>
  <span class="dot" data-index="3"></span>
</div>

<!-- Modal for Card Details -->
<div class="modal" id="detailsModal">
  <div class="modal-content">
    <button class="close-btn">&times;</button>
    <div id="modalBody">
      <!-- Details will be injected here -->
    </div>
  </div>
</div>

<script>
  // ---------- Carousel Auto Slide & Dots Navigation ----------
  const slidesContainer = document.querySelector('.slides');
  const dots = document.querySelectorAll('.dot');
  let currentSlide = 0;
  const totalSlides = dots.length;
  
  function goToSlide(n) {
    currentSlide = (n + totalSlides) % totalSlides;
    slidesContainer.style.transform = 'translateX(-' + (currentSlide * 100) + '%)';
    dots.forEach(dot => dot.classList.remove('active'));
    dots[currentSlide].classList.add('active');
  }
  
  // Auto movement (ہر 5 سیکنڈ بعد سلائیڈ تبدیل ہو)
  let slideInterval = setInterval(() => {
    goToSlide(currentSlide + 1);
  }, 5000);
  
  // Dots click functionality
  dots.forEach(dot => {
    dot.addEventListener('click', function() {
      clearInterval(slideInterval); // Reset auto slide timer on manual click
      goToSlide(parseInt(this.getAttribute('data-index')));
      slideInterval = setInterval(() => { goToSlide(currentSlide + 1); }, 5000);
    });
  });
  
  // ---------- Editable Text with Word Limits (In-Card Editing) ----------
  const TITLE_LIMIT = 10;
  const DESC_LIMIT = 50;
  
  function enforceLimit(el, limit) {
    let words = el.innerText.trim().split(/\s+/);
    if(words.length > limit) {
      el.innerText = words.slice(0, limit).join(" ");
      placeCaretAtEnd(el);
    }
  }
  
  function placeCaretAtEnd(el) {
    el.focus();
    if (window.getSelection && document.createRange) {
      let range = document.createRange();
      range.selectNodeContents(el);
      range.collapse(false);
      let sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
    }
  }
  
  document.querySelectorAll('.text-area h2[contenteditable], .text-area p[contenteditable]').forEach(el => {
    el.addEventListener('input', function() {
      if(el.tagName === "H2") enforceLimit(el, TITLE_LIMIT);
      else enforceLimit(el, DESC_LIMIT);
    });
  });
  
  // ---------- Image Upload within Carousel ----------
  function resizeImage(file, maxWidth, callback) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const img = new Image();
      img.onload = function() {
        const canvas = document.createElement('canvas');
        let width = img.width;
        let height = img.height;
        if (width > maxWidth) {
          height = height * (maxWidth / width);
          width = maxWidth;
        }
        canvas.width = width;
        canvas.height = height;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, width, height);
        callback(canvas.toDataURL('image/jpeg', 0.8));
      }
      img.src = e.target.result;
    }
    reader.readAsDataURL(file);
  }
  
  document.querySelectorAll('.file-input').forEach(input => {
    input.addEventListener('change', function() {
      const cardNum = this.getAttribute('data-card');
      const file = this.files[0];
      if(file) {
        resizeImage(file, 300, function(resizedDataUrl) {
          const imageEl = document.getElementById('img' + cardNum);
          imageEl.src = resizedDataUrl;
          imageEl.style.border = 'none';
        });
      }
    });
  });
  
  document.querySelectorAll('.upload-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.stopPropagation();
      const cardNum = this.getAttribute('data-card');
      document.querySelector('.file-input[data-card="' + cardNum + '"]').click();
    });
  });
  
  // ---------- Details Modal Functionality ----------
  const modal = document.getElementById('detailsModal');
  const modalBody = document.getElementById('modalBody');
  const closeBtn = document.querySelector('.close-btn');
  
  // Open modal when card or details button is clicked
  document.querySelectorAll('.card').forEach(card => {
    card.addEventListener('click', function(e) {
      // اگر کلک details button پر ہو تو دوبارہ modal نہ کھولیں
      if(e.target.classList.contains('upload-btn') || e.target.classList.contains('details-btn')) return;
      const detailsText = this.getAttribute('data-details') || "No details available.";
      modalBody.innerHTML = `<h3>Card ${this.getAttribute('data-card')} Details</h3><p>${detailsText}</p>`;
      modal.style.display = 'flex';
    });
  });
  
  // اگر صرف details button پر کلک ہو تو بھی modal کھلے
  document.querySelectorAll('.details-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.stopPropagation();
      const card = this.closest('.card');
      const detailsText = card.getAttribute('data-details') || "No details available.";
      modalBody.innerHTML = `<h3>Card ${card.getAttribute('data-card')} Details</h3><p>${detailsText}</p>`;
      modal.style.display = 'flex';
    });
  });
  
  // Close modal
  closeBtn.addEventListener('click', function() {
    modal.style.display = 'none';
  });
  window.addEventListener('click', function(e) {
    if(e.target === modal) {
      modal.style.display = 'none';
    }
  });
</script>

</body>
</html>
